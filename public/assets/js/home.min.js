const backsound=new Audio("assets/audios/backsound.mp3"),backsoundToggler=document.querySelector("#btn-backsound-toggler"),loading=document.querySelector("#loading"),floatingButtons=document.querySelector(".floating-buttons"),csrf=document.querySelector("meta[name=csrf]").getAttribute("content"),baseUrl=document.querySelector("meta[name=url]").getAttribute("content");function initAOS(){AOS.init({offset:120,duration:750,easing:"ease-in-out",once:!0})}function openInvitation(){const e=document.querySelector(".onboarding"),t=document.querySelector("main");t.classList.remove("d-none"),t.classList.remove("openned"),e.classList.add("closed"),initAOS(),playBacksound()}function setCountdown(){const e=new Date("2025-2-15")-new Date,t=Math.floor(e/864e5);document.querySelector(".timer-days .number").textContent=t}function copyToClipboard(e){const t=document.querySelector(e),n=document.createElement("textarea");n.value=t.innerText,document.body.appendChild(n),n.select(),n.setSelectionRange(0,99999),navigator.clipboard.writeText(n.value).then((function(){toastSuccess("Copied!")}),(function(e){console.error(e)})),document.body.removeChild(n)}function toggleBacksound(){backsound.paused?playBacksound():pauseBacksound()}function playBacksound(){backsound.play(),backsoundToggler.querySelector(".up").classList.remove("d-none"),backsoundToggler.querySelector(".mute").classList.add("d-none")}function pauseBacksound(){backsound.pause(),backsoundToggler.querySelector(".mute").classList.remove("d-none"),backsoundToggler.querySelector(".up").classList.add("d-none")}function scrollToTop(){window.scrollTo({top:0,behavior:"smooth"})}function toggleGuestCount(e){const t="1"==e.target.value,n=document.querySelector(".guest-count-wrapper"),o=n.querySelector("select[name=num_guest]");t?n.classList.remove("d-none"):(n.classList.add("d-none"),o.selectedIndex=0,document.querySelectorAll(".partner-name-wrapper .input-group").forEach((e=>e.remove())))}function showPartnerInput(e){const t=e.target.value,n=document.querySelector(".partner-name-wrapper");if(n.querySelectorAll(".input-group").forEach((e=>e.remove())),t>=2)for(let e=2;e<=t;e++){const t=document.createElement("div");t.innerHTML=`\n                <div class="input-group mb-3">\n                    <input name="guest${e}name" type="text" class="form-control"\n                        placeholder="Your partner's name" aria-label="Partner's Name" required>\n                </div>\n            `,n.appendChild(t.firstElementChild)}}function fetchRsvps(e=5,t=!1){return;const n=document.querySelector(".comments-wrapper"),o=n.querySelectorAll(".comment-item");let s=e;s=t&&o.length<=e?e:t?o.length:o.length+e,fetch(`${baseUrl}/rsvps/${s}`).then((e=>e.json())).then((({rsvps:e})=>{o.forEach((e=>e.remove())),[...e].forEach((e=>{const t=document.createElement("div");t.innerHTML=`\n                    <div class="comment-item col-12 border-bottom border-danger py-3">\n                        <div class="d-flex align-items-center mb-2 gap-3">\n                            <span class="text-primary text-uppercase fs-16 fw-700 ff-times-new-roman">\n                                ${e.full_name}\n                            </span>\n\n                            <div class="bg-secondary d-flex rounded-pill align-items-center gap-1 px-2 py-1">\n                                <img width="14" height="14"src="${baseUrl}/assets/images/icons/${e.attendance?"check-primary.svg":"times-primary.svg"}">\n                                <span class="fs-14 fs-xs-12 text-primary ff-times-new-roman">\n                                    ${e.attendance?"Will Attend":"Will Not Attend"} \n                                </span>\n                            </div>\n                        </div>\n\n                        <p class="text-primary-dark fs-16 fw-400 ff-times-new-roman mb-2">\n                            ${e.greetings_escaped}\n                        </p>\n\n                        <div class="d-flex gap-2">\n                            <img src="${baseUrl}/assets/images/icons/clock-primary-dark.svg" alt="Clock Icon">\n\n                            <span class="fs-14 fs-xs-12 text-primary-dark ff-times-new-roman">\n                                ${e.create_date_diff}\n                            </span>\n                        </div>\n                    </div>\n                `,n.appendChild(t.firstElementChild)}))})).catch((e=>{console.error(e)}))}function storeRsvp(e){e.preventDefault();const t=e.target,n=new FormData(t),o=t.querySelector("button[type=submit]");validateRsvp(n.get("invitation_id"),(function(){o.setAttribute("disabled",!0),fetch(`${baseUrl}/rsvps`,{method:"POST",headers:{Accept:"application/json","X-CSRF-TOKEN":csrf},body:n}).then((e=>e.json())).then((()=>{t.reset(),document.querySelectorAll(".partner-name-wrapper .input-group").forEach((e=>e.remove())),fetchRsvps(5,!0),toastSuccess("Thank you for your confirmation and blessing!")})).catch((e=>{console.error(e)})).finally((()=>{o.removeAttribute("disabled")}))}))}function validateRsvp(e,t){fetch(`${baseUrl}/rsvps/check/${e}`).then((e=>e.json())).then((({exists:e})=>{e?toastWarning("You already submitted an RSVP."):t()})).catch((e=>{console.error(e)}))}document.addEventListener("DOMContentLoaded",(function(){new Swiper(".swiper-gallery",{spaceBetween:20,slidesPerView:1.2,breakpoints:{1024:{slidesPerView:3}}}),setCountdown(),setInterval((()=>{setCountdown()}),36e5),fetchRsvps()})),window.addEventListener("load",(function(){loading.classList.add("loaded"),setTimeout((()=>{loading.remove()}),500)})),window.addEventListener("scroll",(function(){this.window.scrollY>=300?floatingButtons.style.opacity=1:floatingButtons.style.opacity=0}));